<!DOCTYPE html>
<html>
<head>
    <title>API Contract Validation Report</title>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; margin: 40px; }
        .pass { color: #22c55e; }
        .fail { color: #ef4444; }
        .warning { color: #f59e0b; }
        .endpoint { margin: 20px 0; padding: 15px; border: 1px solid #e5e7eb; border-radius: 8px; }
        .mismatch { background: #fef2f2; padding: 10px; margin: 5px 0; border-radius: 4px; }
        pre { background: #f3f4f6; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>API Contract Validation Report</h1>
    <p>Generated: 2025-10-22T16:07:38.413031</p>
    <p>Mode: strict</p>

    <h2>Summary</h2>
    <ul>
        <li class="pass">✅ Passed: 1</li>
        <li class="fail">❌ Failed: 7</li>
        <li class="warning">⚠️  Warnings: 0</li>
    </ul>
<h2>Failed Validations</h2>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/edges</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">❌ Type mismatch in edges[].line: expected str, got float</div><p><strong>Response Sample:</strong></p><pre>"{\n  \"count\": 1,\n  \"edges\": [\n    {\n      \"confidence\": \"MEDIUM\",\n      \"edge_pct\": 18.47314285714289,\n      \"line\": 0.5,\n      \"matchup\": \"Jaxson Dart vs New York Giants\",\n      \"opponent\": \"New York Giants\",\n      \"reasoning\": \"Jaxson Dart has true probability of 80.3% vs market implied probability of 67.7% (New York Giants defense). Edge: 18.5%\",\n      \"recommendation\": \"OVER 0.5 TD\",\n      \"red_zone_td_rate\": null,\n      \"strategy\": \"QB TD 0.5+ (Enhanced v2)\",\n      \"v1_edge_pct\": null\n    }\n\n... (truncated)"</pre></div>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/current-week</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">❌ Missing required field: 'success'</div><p><strong>Response Sample:</strong></p><pre>{
  "week": 7
}</pre></div>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/week-range</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">❌ Missing required field: 'success'</div><div class="mismatch">❌ Missing required field: 'min_week'</div><div class="mismatch">❌ Missing required field: 'max_week'</div><p><strong>Response Sample:</strong></p><pre>{
  "available_weeks": [
    7,
    8,
    9,
    10
  ],
  "current_week": 7
}</pre></div>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/weak-defenses</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">❌ Missing required field: 'success'</div><div class="mismatch">Unexpected error: 'list' object has no attribute 'keys'</div><p><strong>Response Sample:</strong></p><pre>"[\n  {\n    \"games_played\": 6,\n    \"pass_tds_allowed\": 15,\n    \"scraped_at\": \"2025-10-21T17:43:06.885387\",\n    \"tds_per_game\": 2.5,\n    \"team_name\": \"Chicago Bears\"\n  },\n  {\n    \"games_played\": 7,\n    \"pass_tds_allowed\": 17,\n    \"scraped_at\": \"2025-10-21T17:43:06.885387\",\n    \"tds_per_game\": 2.43,\n    \"team_name\": \"Cincinnati Bengals\"\n  },\n  {\n    \"games_played\": 6,\n    \"pass_tds_allowed\": 14,\n    \"scraped_at\": \"2025-10-21T17:43:06.885387\",\n    \"tds_per_game\": 2.33,\n    \"team_name\": \"Baltimore Rav\n... (truncated)"</pre></div>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/stats/summary</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">❌ Missing required field: 'success'</div><div class="mismatch">❌ Missing required field: 'total_records'</div><div class="mismatch">❌ Missing required field: 'weeks_available'</div><p><strong>Response Sample:</strong></p><pre>{
  "database_path": "data/database/nfl_betting.db",
  "database_size_mb": 14.48828125,
  "defense_stats": 32,
  "matchups": 2,
  "odds_spreads": 428,
  "odds_totals": 108,
  "qb_props": 1,
  "qb_stats": 141
}</pre></div>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/data-status</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">❌ Missing required field: 'success'</div><div class="mismatch">❌ Missing required field: 'last_updated'</div><p><strong>Response Sample:</strong></p><pre>{
  "completeness": {
    "defense_stats": 32,
    "matchups": 2,
    "qb_props": 1,
    "qb_stats": 141
  },
  "configured_week": 7,
  "has_data": true,
  "issues": [],
  "qb_props_count": 1,
  "status": "healthy",
  "warnings": [
    "140 QBs missing team assignments (99.3%) - Edge detection may be limited",
    "Only 1 QBs with props (expected ~32) - Edge opportunities may be limited"
  ]
}</pre></div>
                <div class="endpoint">
                    <h3 class="fail">❌ /api/edge/explain</h3>
                    <p><strong>Issues Found:</strong></p>
<div class="mismatch">HTTP 404: <!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL </div></div><h2>Passed Validations</h2><div class="endpoint"><h3 class="pass">✅ /api/edges/counts</h3></div></body></html>